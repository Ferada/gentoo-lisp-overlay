--- last/chicken-2.732/defaults.make	2007-11-02 03:00:15.000000000 +0000
+++ chicken-2.732/defaults.make	2007-11-04 18:12:05.000000000 +0000
@@ -126,6 +126,7 @@
 LINKER_OUTPUT_OPTION ?= -o
 LINKER_LIBRARY_OPTION ?= -l
 LINKER_LINK_SHARED_LIBRARY_OPTIONS ?= -shared
+LINKER_SONAME_VERSIONING_OPTIONS ?= -Wl,-shared,-soname,
 LIBRARIAN_OPTIONS ?= cru
 LIBRARIES ?= -lm
 ifeq ($(PLATFORM),mingw)
@@ -144,7 +145,7 @@
 ASSEMBLER_OPTIONS ?= $(C_COMPILER_OPTIONS)
 ASSEMBLER_OUTPUT_OPTION ?= -o
 ASSEMBLER_COMPILE_OPTION ?= -c
-PRIMARY_LIBCHICKEN ?= libchicken$(SO)
+PRIMARY_LIBCHICKEN ?= libchicken$(SO)$(SO_MAIN_VERSION)$(SO_SECONDARY_VERSION)
 UNINSTALLINFO_PROGRAM_OPTIONS ?= --delete
 LIBCHICKEN_SO_LIBRARIES ?= $(LIBRARIES)
 LIBUCHICKEN_SO_LIBRARIES ?= $(LIBRARIES)
@@ -168,6 +169,9 @@
 A ?= .a
 # EXE =
 SO ?= .so
+# Hack to manage versioning support without libtool, for porting to gentoo.
+SO_MAIN_VERSION ?= .1
+SO_SECONDARY_VERSION ?= .1
 
 # special files
 
@@ -216,8 +220,8 @@
 CSI_SHARED_EXECUTABLE = $(CSI_PROGRAM)$(EXE)
 TARGETS ?= libchicken$(A) libuchicken$(A) $(CHICKEN_SHARED_EXECUTABLE) \
 	$(CSI_SHARED_EXECUTABLE) $(CHICKEN_PROFILE_PROGRAM)$(EXE) \
-	$(CSC_PROGRAM)$(EXE) libchicken$(SO) \
-	libuchicken$(SO) $(CHICKEN_SETUP_PROGRAM)$(EXE) chicken.info \
+	$(CSC_PROGRAM)$(EXE) libchicken$(SO)$(SO_MAIN_VERSION)$(SO_SECONDARY_VERSION) \
+	libuchicken$(SO)$(SO_MAIN_VERSION)$(SO_SECONDARY_VERSION) $(CHICKEN_SETUP_PROGRAM)$(EXE) chicken.info \
 	$(CHICKEN_BUG_PROGRAM)$(EXE)
 endif
 
